<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Primary Meta Tags -->
  <title>Shop - Merch, Courses & Gear | AutoNateAI</title>
  <meta name="title" content="Shop - Merch, Courses & Gear | AutoNateAI">
  <meta name="description" content="Premium AI-inspired streetwear, developer courses, and starter packs. Engineer your future. Wear the code. We Bot dat life.">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://autonateai.com/shop">
  <meta property="og:title" content="Shop - Merch, Courses & Gear | AutoNateAI">
  <meta property="og:description" content="Premium AI-inspired streetwear, developer courses, and starter packs for builders and innovators.">
  <meta property="og:image" content="assets/og-shop.png">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://autonateai.com/shop">
  <meta property="twitter:title" content="Shop - Merch, Courses & Gear | AutoNateAI">
  <meta property="twitter:description" content="Premium AI-inspired streetwear, developer courses, and starter packs for builders and innovators.">
  <meta property="twitter:image" content="assets/og-shop.png">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>&#x1F3DB;</text></svg>">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="shared/css/marketing.css">
  <link rel="stylesheet" href="shared/css/shop.css">
  <link rel="stylesheet" href="shared/css/i18n.css">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="shared/js/firebase-config.js"></script>
  <script src="shared/js/auth.js"></script>

  <!-- Anime.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>

  <!-- Shared Components -->
  <script src="shared/js/navbar.js" defer></script>
  <script src="shared/js/footer.js" defer></script>
  <script src="shared/js/whop-service.js" defer></script>
  <script src="shared/js/purchase-service.js" defer></script>
  <script src="shared/js/cart-service.js" defer></script>
</head>
<body>

  <!-- ==================== NAVIGATION ==================== -->
  <div id="navbar-container"></div>

  <!-- ==================== SHOP SUB-NAV ==================== -->
  <nav class="shop-subnav" id="shop-subnav">
    <div class="shop-subnav-container">
      <div class="shop-subnav-categories" id="subnav-categories">
        <button class="shop-subnav-item active" data-category="all" data-i18n="shop.tab_all">All</button>
        <button class="shop-subnav-item" data-category="ai-tees" data-i18n="shop.tab_ai_tees">AI Tees</button>
        <button class="shop-subnav-item" data-category="developer-hoodies" data-i18n="shop.tab_hoodies">Developer Hoodies</button>
        <button class="shop-subnav-item" data-category="women-in-tech" data-i18n="shop.tab_women">Women in Tech</button>
        <button class="shop-subnav-item" data-category="limited-drops" data-i18n="shop.tab_limited">Limited Drops</button>
        <button class="shop-subnav-item" data-category="starter-packs" data-i18n="shop.tab_starters">Starter Packs</button>
        <button class="shop-subnav-item" data-category="accessories" data-i18n="shop.tab_accessories">Accessories</button>
        <button class="shop-subnav-item" data-category="courses" data-i18n="shop.tab_courses">Courses</button>
      </div>
      <div class="shop-subnav-actions">
        <div class="lang-selector" id="lang-selector">
          <button class="action-btn lang-btn" id="lang-btn" title="Language">
            <span class="lang-flag" id="lang-flag">ðŸ‡ºðŸ‡¸</span>
            <span class="lang-code" id="lang-code">EN</span>
          </button>
          <div class="lang-dropdown" id="lang-dropdown"></div>
        </div>
        <div class="shop-search-bar" id="search-toggle">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
          <span class="shop-search-placeholder" data-i18n="shop.search_placeholder">Search products, courses...</span>
          <kbd class="shop-search-key">/</kbd>
        </div>
        <button class="shop-cart-btn" id="cart-toggle" aria-label="Shopping cart">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
          <span class="cart-badge" id="cart-badge">0</span>
        </button>
      </div>
    </div>
    <!-- Hover preview dropdown -->
    <div class="subnav-preview" id="subnav-preview">
      <div class="subnav-preview-inner" id="subnav-preview-inner"></div>
    </div>
  </nav>

  <!-- ==================== HERO STAGE (Manifesto â†” Hero) ==================== -->
  <div class="hero-stage" id="hero-stage">

    <!-- Layer 1: Manifesto -->
    <section class="manifesto-section manifesto-layer" id="manifesto">
      <div class="manifesto-bg">
        <div class="manifesto-particles"></div>
        <div class="manifesto-streak"></div>
        <div class="manifesto-streak streak-2"></div>
        <div class="manifesto-streak streak-3"></div>
      </div>
      <div class="manifesto-glow"></div>
      <div class="manifesto-container">
        <p class="manifesto-lead" data-i18n="shop.manifesto_lead">We Don't Follow The Future.</p>
        <h2 class="manifesto-headline" data-i18n="shop.manifesto_headline">We Build It.</h2>
        <div class="manifesto-body">
          <p data-i18n="shop.manifesto_p1">AI isn't hype. It's power.</p>
          <p data-i18n-html="shop.manifesto_p2">For the coders. The creators.<br>The women rewriting the rules.<br>The builders who stay up when others log off.</p>
          <p data-i18n-html="shop.manifesto_p3">AutoNateAI is more than apparel.<br>It's a uniform for the next era.</p>
          <p data-i18n-html="shop.manifesto_p4">You don't just wear it. <span class="manifesto-bold">You represent it.</span></p>
        </div>
        <p class="manifesto-tagline" data-i18n="shop.manifesto_tagline">We Bot Dat Life.</p>
      </div>
    </section>

    <!-- Layer 2: Hero Banner -->
    <section class="shop-hero-banner hero-layer" id="hero">
      <div class="shop-hero-bg">
        <div class="hero-particles"></div>
        <div class="hero-light-streak"></div>
        <div class="hero-light-streak streak-2"></div>
      </div>
      <div class="shop-hero-container">
        <div class="shop-hero-text">
          <h1 class="shop-hero-title">
            <span data-i18n="shop.hero_line1">ENGINEER YOUR FUTURE.</span><br>
            <span class="hero-accent" data-i18n="shop.hero_line2">WEAR THE CODE.</span>
          </h1>
          <p class="shop-hero-subtitle" data-i18n="shop.hero_subtitle">Premium AI-inspired streetwear for builders and innovators.</p>
          <div class="shop-hero-ctas">
            <a href="#products" class="btn btn-primary btn-lg" data-i18n="shop.shop_now">SHOP NOW</a>
            <a href="#courses" class="btn btn-secondary btn-lg" data-i18n="shop.explore_collections">EXPLORE COLLECTIONS</a>
          </div>
          <div class="trust-badges">
            <div class="trust-badge">
              <span class="trust-icon">&#9733;</span>
              <span data-i18n="shop.rating">4.8 Rating</span>
            </div>
            <div class="trust-badge">
              <span class="trust-icon">&#128666;</span>
              <span data-i18n="shop.free_ship_50">Free Shipping $50+</span>
            </div>
            <div class="trust-badge">
              <span class="trust-icon">&#8635;</span>
              <span data-i18n="shop.returns_30">30 Day Returns</span>
            </div>
          </div>
        </div>
        <div class="shop-hero-image">
          <div class="hero-glow"></div>
          <img src="assets/shop/logo-glow.png" alt="AutoNateAI" class="hero-logo-img">
        </div>
      </div>
    </section>

  </div>

  <!-- ==================== PRODUCT GRID ==================== -->
  <section class="shop-products" id="products">
    <div class="shop-products-header">
      <h2 class="shop-products-title" data-i18n="shop.shop_all">Shop All</h2>
      <div class="shop-sort-wrapper">
        <label for="sort-select" class="sort-label" data-i18n="shop.sort_by">Sort by:</label>
        <select id="sort-select" class="sort-select">
          <option value="featured">Featured</option>
          <option value="price-asc">Price: Low to High</option>
          <option value="price-desc">Price: High to Low</option>
          <option value="newest">Newest</option>
          <option value="best-sellers">Best Sellers</option>
          <option value="top-rated">Top Rated</option>
        </select>
      </div>
    </div>
    <div class="product-grid" id="product-grid">
      <!-- Rendered by JS -->
    </div>
    <div class="product-grid-status" id="grid-status"></div>
  </section>

  <!-- ==================== FREQUENTLY BOUGHT TOGETHER ==================== -->
  <section class="fbt-section" id="fbt">
    <div class="fbt-wrapper">
      <h2 class="section-title-sm" data-i18n="shop.fbt_title">Frequently Bought Together</h2>
      <div class="fbt-container" id="fbt-container">
        <!-- Rendered by JS -->
      </div>
    </div>
  </section>

  <!-- ==================== COURSES & LEARNING PATHS ==================== -->
  <section class="courses-section" id="courses">
    <div class="section-container">
      <div class="section-header">
        <span class="section-badge" data-i18n="shop.learn_build">LEARN &amp; BUILD</span>
        <h2 class="section-title" data-i18n="shop.level_up">Level Up Your Skills</h2>
        <p class="section-subtitle" data-i18n="shop.level_up_desc">From complete beginner to senior engineer. AI-augmented courses with real-world projects.</p>
      </div>

      <!-- Featured Courses Carousel -->
      <div class="courses-carousel-wrapper">
        <div class="subsection-header">
          <h3 class="subsection-title" data-i18n="shop.featured_courses">Featured Courses</h3>
          <div class="carousel-nav">
            <button class="carousel-btn carousel-prev" id="courses-prev" aria-label="Previous">&#8249;</button>
            <button class="carousel-btn carousel-next" id="courses-next" aria-label="Next">&#8250;</button>
          </div>
        </div>
        <div class="courses-carousel" id="courses-carousel">
          <!-- Rendered by JS -->
        </div>
      </div>

      <!-- Learning Paths -->
      <div class="learning-paths">
        <h3 class="subsection-title" data-i18n="shop.learning_paths">Learning Paths</h3>
        <div class="paths-grid">
          <div class="path-card">
            <div class="path-icon">&#127891;</div>
            <div class="path-info">
              <h4 data-i18n="shop.zero_to_dev">Zero to Developer</h4>
              <p>2 courses &bull; 12 weeks &bull; Certificate</p>
            </div>
            <a href="course/apprentice.html" class="path-cta" data-i18n="shop.start_path">Start Path &#8594;</a>
          </div>
          <div class="path-card">
            <div class="path-icon">&#9889;</div>
            <div class="path-info">
              <h4 data-i18n="shop.ai_engineering">AI-Augmented Engineering</h4>
              <p>2 courses &bull; 8-16 weeks &bull; Certificate</p>
            </div>
            <a href="course/junior.html" class="path-cta" data-i18n="shop.start_path">Start Path &#8594;</a>
          </div>
          <div class="path-card">
            <div class="path-icon">&#128640;</div>
            <div class="path-info">
              <h4 data-i18n="shop.full_stack">The Full Stack</h4>
              <p>All courses &bull; 24 weeks &bull; Master Certificate</p>
            </div>
            <a href="#" class="path-cta" data-i18n="shop.start_path">Start Path &#8594;</a>
          </div>
        </div>
      </div>

      <!-- Enterprise Banner -->
      <div class="enterprise-banner">
        <div class="enterprise-text">
          <h3 data-i18n="shop.teams_title">AutoNateAI for Teams</h3>
          <p data-i18n="shop.teams_desc">Custom learning paths for your engineering team. Bulk pricing available.</p>
        </div>
        <a href="enterprise.html" class="btn btn-secondary" data-i18n="shop.contact_sales">Contact Sales</a>
      </div>
    </div>
  </section>

  <!-- ==================== DROP OF THE MONTH ==================== -->
  <section class="drop-section" id="drop">
    <div class="drop-container">
      <div class="drop-info">
        <span class="drop-label" data-i18n="shop.drop_label">DROP OF THE MONTH</span>
        <h2 class="drop-title" data-i18n-html="shop.drop_title_html">DROP 01 &mdash; <span class="hero-accent">AI ORIGIN</span></h2>
        <div class="countdown" id="drop-countdown">
          <div class="countdown-unit">
            <span class="countdown-value" id="cd-days">00</span>
            <span class="countdown-label" data-i18n="shop.cd_days">Days</span>
          </div>
          <span class="countdown-sep">:</span>
          <div class="countdown-unit">
            <span class="countdown-value" id="cd-hours">00</span>
            <span class="countdown-label" data-i18n="shop.cd_hours">Hours</span>
          </div>
          <span class="countdown-sep">:</span>
          <div class="countdown-unit">
            <span class="countdown-value" id="cd-mins">00</span>
            <span class="countdown-label" data-i18n="shop.cd_min">Min</span>
          </div>
          <span class="countdown-sep">:</span>
          <div class="countdown-unit">
            <span class="countdown-value" id="cd-secs">00</span>
            <span class="countdown-label" data-i18n="shop.cd_sec">Sec</span>
          </div>
        </div>
        <p class="drop-desc" data-i18n="shop.drop_desc">Pre-order the first limited-edition AutoNateAI drop engineered for AI visionaries.</p>
        <p class="drop-includes" data-i18n="shop.drop_includes">Set incl. Tee, Free coaster, Matrix Dev Hoodie.</p>
        <button class="btn btn-secondary btn-glow" data-i18n="shop.reserve">Reserve Your Spot</button>
      </div>
      <div class="drop-image">
        <div class="drop-glow"></div>
        <img src="assets/shop/ai-origin-drop-tee.png" alt="AI Origin Collection" class="drop-product-img">
        <span class="drop-collection-label" data-i18n="shop.drop_collection">AI ORIGIN COLLECTION</span>
      </div>
    </div>
    <!-- Built for Builders alongside drop -->
    <div class="brand-story-card">
      <h3 class="brand-story-title" data-i18n="shop.built_for">Built for Builders</h3>
      <ul class="brand-values-list">
        <li><span class="check-icon">&#10003;</span> <span data-i18n="shop.designed_devs">Designed by Devs for Devs</span></li>
        <li><span class="check-icon">&#10003;</span> <span data-i18n="shop.premium_fab">Premium, Sustainable Fabrics</span></li>
        <li><span class="check-icon">&#10003;</span> <span data-i18n="shop.supports_tech">Supports the Tech Community</span></li>
      </ul>
      <a href="about.html" class="btn btn-secondary" data-i18n="shop.learn_more">Learn More</a>
    </div>
  </section>

  <!-- ==================== SOCIAL PROOF ==================== -->
  <section class="social-proof-strip">
    <div class="social-proof-content">
      <div class="testimonial-stars">&#9733;&#9733;&#9733;&#9733;&#9733;</div>
      <blockquote class="testimonial-quote" data-i18n="shop.testimonial_quote">"Finally, gear that speaks our language."</blockquote>
      <cite class="testimonial-author" data-i18n="shop.testimonial_author">&mdash; Jay, Software Engineer</cite>
      <div class="proof-stats">
        <div class="proof-stat">
          <span class="proof-stat-value">4,200+</span>
          <span class="proof-stat-label" data-i18n="shop.stat_members">Community Members</span>
        </div>
        <div class="proof-stat">
          <span class="proof-stat-value">500+</span>
          <span class="proof-stat-label" data-i18n="shop.stat_sold">Products Sold</span>
        </div>
        <div class="proof-stat">
          <span class="proof-stat-value">4.8/5</span>
          <span class="proof-stat-label" data-i18n="shop.stat_rating">Average Rating</span>
        </div>
      </div>
    </div>
  </section>

  <!-- ==================== COMMUNITY GALLERY ==================== -->
  <section class="community-gallery" id="lookbook">
    <div class="gallery-header">
      <h2 class="section-title" data-i18n="shop.gallery_title">#WeBotDatLife</h2>
      <p class="section-subtitle" data-i18n="shop.community">The community repping AutoNateAI</p>
    </div>
    <div class="gallery-grid">
      <div class="gallery-item">
        <div class="gallery-placeholder">
          <img src="assets/shop/logo-glow.png" alt="AI Tees" class="gallery-logo-img" loading="lazy">
          <span class="gallery-label">AI Tees</span>
        </div>
        <div class="gallery-overlay"><span data-i18n="shop.shop_this_look">Shop this look &#8594;</span></div>
      </div>
      <div class="gallery-item">
        <div class="gallery-placeholder">
          <img src="assets/shop/logo-glow.png" alt="Dev Hoodies" class="gallery-logo-img" loading="lazy">
          <span class="gallery-label">Dev Hoodies</span>
        </div>
        <div class="gallery-overlay"><span data-i18n="shop.shop_this_look">Shop this look &#8594;</span></div>
      </div>
      <div class="gallery-item">
        <div class="gallery-placeholder">
          <img src="assets/shop/logo-glow.png" alt="Community" class="gallery-logo-img" loading="lazy">
          <span class="gallery-label">Community</span>
        </div>
        <div class="gallery-overlay"><span data-i18n="shop.shop_this_look">Shop this look &#8594;</span></div>
      </div>
      <div class="gallery-item">
        <div class="gallery-placeholder">
          <img src="assets/shop/logo-glow.png" alt="Starter Packs" class="gallery-logo-img" loading="lazy">
          <span class="gallery-label">Starter Packs</span>
        </div>
        <div class="gallery-overlay"><span data-i18n="shop.shop_this_look">Shop this look &#8594;</span></div>
      </div>
      <div class="gallery-item">
        <div class="gallery-placeholder">
          <img src="assets/shop/logo-glow.png" alt="Limited Drops" class="gallery-logo-img" loading="lazy">
          <span class="gallery-label">Limited Drops</span>
        </div>
        <div class="gallery-overlay"><span data-i18n="shop.shop_this_look">Shop this look &#8594;</span></div>
      </div>
      <div class="gallery-item">
        <div class="gallery-placeholder">
          <img src="assets/shop/logo-glow.png" alt="Accessories" class="gallery-logo-img" loading="lazy">
          <span class="gallery-label">Accessories</span>
        </div>
        <div class="gallery-overlay"><span data-i18n="shop.shop_this_look">Shop this look &#8594;</span></div>
      </div>
    </div>
  </section>

  <!-- ==================== MEMBERS SECTION ==================== -->
  <section class="members-section" id="members">
    <div class="members-container">
      <div class="members-text">
        <span class="section-badge" data-i18n="shop.membership">MEMBERSHIP</span>
        <h2 class="section-title" data-i18n="shop.members_more">AutoNateAI Members Get More</h2>
        <ul class="members-perks">
          <li><span class="perk-icon">&#9889;</span> <span data-i18n="shop.early_access">Early access to limited drops</span></li>
          <li><span class="perk-icon">&#128176;</span> <span data-i18n="shop.member_disc">Member-exclusive discounts</span></li>
          <li><span class="perk-icon">&#128666;</span> <span data-i18n="shop.free_shipping">Free shipping on all orders</span></li>
          <li><span class="perk-icon">&#127891;</span> <span data-i18n="shop.priority_enroll">Priority course enrollment</span></li>
          <li><span class="perk-icon">&#128172;</span> <span data-i18n="shop.community_feed">Community feed access</span></li>
        </ul>
        <div class="members-ctas" id="members-ctas">
          <a href="auth/register.html" class="btn btn-primary" data-i18n="shop.join_free">Join Free</a>
          <a href="auth/login.html" class="btn btn-secondary" data-i18n="shop.sign_in">Sign In</a>
        </div>
      </div>
      <div class="members-visual">
        <div class="members-logo-glow"></div>
        <img src="assets/shop/logo-glow.png" alt="AutoNateAI" class="members-logo-img">
        <span class="members-brand">AUTONATEAI</span>
        <small class="members-tagline">We Bot dat life</small>
      </div>
    </div>
  </section>

  <!-- ==================== FINAL CTA ==================== -->
  <section class="cta-section">
    <h2 class="cta-title" data-i18n="shop.gear_up">Gear Up. Stand Out. Build Different.</h2>
    <p class="cta-subtitle" data-i18n="shop.gear_up_desc">Join the community of builders repping AutoNateAI. New drops every month.</p>
    <div class="cta-buttons">
      <a href="#products" class="btn btn-primary" data-i18n="shop.shop_all_products">Shop All Products <span>&#8594;</span></a>
      <a href="dashboard/feed.html" class="btn btn-secondary" data-i18n="shop.join_community">Join the Community</a>
    </div>
  </section>

  <!-- ==================== FOOTER ==================== -->
  <div id="footer-container"></div>

  <!-- ==================== CART DRAWER ==================== -->
  <div class="cart-overlay" id="cart-overlay"></div>
  <div class="cart-drawer" id="cart-drawer">
    <div class="cart-drawer-header">
      <h3>Your Cart (<span id="cart-count">0</span>)</h3>
      <button class="cart-close" id="cart-close" aria-label="Close cart">&times;</button>
    </div>
    <div class="cart-drawer-items" id="cart-items"></div>
    <div class="cart-drawer-empty" id="cart-empty">
      <span class="empty-cart-icon">&#128722;</span>
      <p data-i18n="shop.cart_empty">Your cart is empty</p>
      <a href="#products" class="btn btn-primary btn-sm" id="start-shopping-btn" data-i18n="shop.start_shopping">Start Shopping</a>
    </div>
    <div class="cart-upsell" id="cart-upsell">
      <h4 data-i18n="shop.you_might_like">You might also like</h4>
      <div class="cart-upsell-items" id="cart-upsell-items"></div>
    </div>
    <div class="cart-drawer-footer" id="cart-footer">
      <div class="cart-subtotal">
        <span data-i18n="shop.subtotal">Subtotal:</span>
        <span class="cart-total-price" id="cart-total-price">$0.00</span>
      </div>
      <p class="cart-shipping-note" data-i18n="shop.shipping_note">Shipping calculated at checkout</p>
      <button class="btn btn-primary btn-full cart-checkout-btn" id="cart-checkout">Checkout <span>&#8594;</span></button>
    </div>
  </div>

  <!-- ==================== SEARCH OVERLAY ==================== -->
  <div class="search-overlay" id="search-overlay">
    <div class="search-modal">
      <div class="search-input-wrapper">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        <input type="text" id="search-input" placeholder="Search tees, hoodies, courses, accessories..." data-i18n-placeholder="shop.search_placeholder" autocomplete="off">
        <kbd class="search-shortcut" id="search-shortcut">/</kbd>
        <button class="search-close" id="search-close" aria-label="Close search">&times;</button>
      </div>
      <div class="search-filter-chips" id="search-chips">
        <button class="search-chip active" data-filter="all">All</button>
        <button class="search-chip" data-filter="ai-tees">Tees</button>
        <button class="search-chip" data-filter="developer-hoodies">Hoodies</button>
        <button class="search-chip" data-filter="women-in-tech">Women in Tech</button>
        <button class="search-chip" data-filter="accessories">Accessories</button>
        <button class="search-chip" data-filter="courses">Courses</button>
      </div>
      <div class="search-results" id="search-results"></div>
      <div class="search-footer" id="search-footer">
        <span class="search-result-count" id="search-count"></span>
        <span class="search-hint" data-i18n="shop.search_hint">Press ESC to close</span>
      </div>
    </div>
  </div>

  <!-- ==================== SCRIPTS ==================== -->
  <script>
    /* ========================================
       AutoNateAI Shop Page â€” Main Script
       ======================================== */

    let allProducts = [];
    let currentFilter = 'all';
    let currentSort = 'featured';

    document.addEventListener('DOMContentLoaded', () => {
      // Init shared components
      NavbarComponent.inject('navbar-container');
      FooterComponent.inject('footer-container');

      // Init cart
      if (typeof CartService !== 'undefined') {
        CartService.init();
      }

      // Handle purchase return
      if (typeof PurchaseService !== 'undefined') {
        const purchaseResult = PurchaseService.handlePurchaseReturn();
        if (purchaseResult) showPurchaseToast(purchaseResult);
      }

      // Load products & render
      loadProducts();

      // Setup interactions
      setupSubnavFilters();
      setupSortDropdown();
      setupCartDrawer();
      setupSearch();
      setupCountdown();
      setupMembersAuth();

      // Entry animations
      runEntryAnimations();

      // Re-render dynamic content when language changes
      if (window.I18n && window.I18n.onChange) {
        window.I18n.onChange(function() {
          renderProducts();
          renderFBT();
          renderCoursesCarousel();
          if (typeof CartService !== 'undefined') CartService.renderDrawer();
        });
      }
    });

    /* ---- PRODUCT LOADING ---- */
    function loadProducts() {
      if (typeof WhopService === 'undefined') return;
      allProducts = WhopService.getProducts();
      renderProducts();
      renderFBT();
      renderCoursesCarousel();
    }

    /* ---- RENDER PRODUCTS ---- */
    function renderProducts() {
      const grid = document.getElementById('product-grid');
      const status = document.getElementById('grid-status');
      if (!grid) return;

      let filtered = currentFilter === 'all'
        ? allProducts
        : allProducts.filter(p => p.category === currentFilter);

      // Sort
      filtered = sortProducts(filtered, currentSort);

      grid.innerHTML = '';

      if (filtered.length === 0) {
        const _t = window.I18n ? window.I18n.t : function(k) { return k; };
        grid.innerHTML = '<div class="no-results">' + _t('shop.no_products') + '</div>';
        status.textContent = '';
        return;
      }

      status.textContent = `${filtered.length} product${filtered.length !== 1 ? 's' : ''}`;

      filtered.forEach(product => {
        grid.appendChild(createProductCard(product));
      });

      // Animate cards
      anime({
        targets: '#product-grid .product-card',
        opacity: [0, 1],
        translateY: [30, 0],
        delay: anime.stagger(60),
        duration: 500,
        easing: 'easeOutCubic'
      });
    }

    /* ---- TRANSLATE PRODUCT HELPER ---- */
    function tp(product, field) {
      var key = 'product.' + product.id + '.' + (field === 'description' ? 'desc' : field);
      if (window.I18n) {
        var val = window.I18n.t(key);
        if (val !== key) return val;
      }
      return product[field];
    }
    function fp(amount) {
      return window.I18n ? window.I18n.formatPrice(amount) : '$' + amount.toFixed(2);
    }

    /* ---- CREATE PRODUCT CARD ---- */
    function createProductCard(product) {
      const card = document.createElement('div');
      card.className = `product-card${product.type === 'course' ? ' card-course' : ''}${product.type === 'bundle' ? ' card-bundle' : ''}`;
      card.dataset.category = product.category;
      card.dataset.type = product.type || 'merch';
      card.dataset.productId = product.id;

      const _t = window.I18n ? window.I18n.t : function(k) { return k; };
      const pName = tp(product, 'name');

      // Badge
      const badgeHtml = product.badge
        ? `<span class="product-badge badge-${product.badge}">${formatBadge(product.badge)}</span>`
        : '';

      // Stars
      const starPercent = ((product.rating || 0) / 5) * 100;
      const reviewText = product.type === 'course'
        ? `(${(product.reviewCount || 0).toLocaleString()} ${_t('shop.students')})`
        : `(${(product.reviewCount || 0).toLocaleString()})`;

      // Price â€” localized currency
      const originalPriceHtml = product.originalPrice
        ? `<span class="product-price-original">${fp(product.originalPrice)}</span>`
        : '';
      const discountHtml = product.originalPrice
        ? `<span class="discount-badge">${Math.round((1 - product.price / product.originalPrice) * 100)}% ${_t('shop.off')}</span>`
        : '';

      // Level badge (courses)
      const levelHtml = product.level
        ? `<span class="course-level level-${product.level}">${product.level.charAt(0).toUpperCase() + product.level.slice(1)}</span>`
        : '';

      // Instructor (courses)
      const instructorHtml = product.instructor
        ? `<p class="course-instructor">${product.instructor}</p>`
        : '';

      // Course meta
      const courseMetaHtml = product.chapters
        ? `<div class="course-meta-row">
            <span>&#128218; ${product.chapters} ${_t('shop.chapters')}</span>
            ${product.capstones ? `<span>&#127919; ${product.capstones} ${_t('shop.capstones')}</span>` : ''}
           </div>`
        : '';

      // Duration badge overlay
      const durationHtml = product.duration
        ? `<span class="course-duration-badge">${product.duration}</span>`
        : '';

      // Bundle contents
      const bundleHtml = product.type === 'bundle' && product.bundleContents
        ? `<p class="bundle-contents">${product.bundleContents}</p>
           <div class="bundle-savings">
             <span class="savings-label">${_t('shop.you_save')}</span>
             <span class="savings-amount">${fp(product.savings || 0)} (${product.originalPrice ? Math.round((1 - product.price / product.originalPrice) * 100) : 0}%)</span>
           </div>`
        : '';

      // CTA text
      const ctaText = product.type === 'course' ? _t('shop.enroll_now') : product.type === 'bundle' ? _t('shop.add_bundle') : _t('shop.add_to_cart');
      const ctaIcon = product.type === 'course' ? '&#8594;' : '&#128722;';
      const ctaClass = product.type === 'course' ? 'btn-enroll' : product.type === 'bundle' ? 'btn-bundle' : '';

      // Image
      const imageHtml = product.image
        ? `<img src="${product.image}" alt="${pName}" loading="lazy">`
        : `<div class="product-placeholder-img">
            <img src="assets/shop/logo-glow.png" alt="${pName}" class="placeholder-logo-img" loading="lazy">
            <span class="placeholder-product-label">${pName}</span>
          </div>`;

      card.innerHTML = `
        <div class="product-card-media">
          ${badgeHtml}
          ${imageHtml}
          ${durationHtml}
          <button class="quick-view-trigger" aria-label="Quick view ${pName}">${_t('shop.quick_view')}</button>
        </div>
        <div class="product-card-info">
          ${levelHtml}
          <h3 class="product-name">${pName}</h3>
          ${instructorHtml}
          <div class="product-rating-row">
            <div class="star-rating" aria-label="${product.rating} out of 5 stars">
              <span class="stars-bg">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
              <span class="stars-filled" style="width:${starPercent}%">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
            </div>
            <span class="review-count">${reviewText}</span>
          </div>
          ${courseMetaHtml}
          ${bundleHtml}
          <div class="product-price-row">
            <span class="product-price">${fp(product.price)}</span>
            ${originalPriceHtml}
            ${discountHtml}
          </div>
          <button class="btn-add-to-cart ${ctaClass}" data-product-id="${product.id}">
            ${ctaText} <span>${ctaIcon}</span>
          </button>
        </div>
      `;

      // Add to cart handler
      card.querySelector('.btn-add-to-cart').addEventListener('click', (e) => {
        e.stopPropagation();
        handleAddToCart(product);
      });

      return card;
    }

    /* ---- SORT PRODUCTS ---- */
    function sortProducts(products, sortBy) {
      const sorted = [...products];
      switch (sortBy) {
        case 'price-asc': return sorted.sort((a, b) => a.price - b.price);
        case 'price-desc': return sorted.sort((a, b) => b.price - a.price);
        case 'top-rated': return sorted.sort((a, b) => (b.rating || 0) - (a.rating || 0));
        case 'best-sellers': return sorted.sort((a, b) => (b.reviewCount || 0) - (a.reviewCount || 0));
        case 'newest': return sorted.sort((a, b) => (b.isNew ? 1 : 0) - (a.isNew ? 1 : 0));
        default: return sorted.sort((a, b) => (b.featured ? 1 : 0) - (a.featured ? 1 : 0));
      }
    }

    /* ---- FORMAT BADGE ---- */
    function formatBadge(badge) {
      return badge.replace(/-/g, ' ').toUpperCase();
    }

    /* ---- SUBNAV FILTERS ---- */
    function setupSubnavFilters() {
      const container = document.getElementById('subnav-categories');
      const preview = document.getElementById('subnav-preview');
      const previewInner = document.getElementById('subnav-preview-inner');
      let hoverTimeout = null;
      let hideTimeout = null;

      if (!container) return;

      // Click â€” switch tab
      container.addEventListener('click', (e) => {
        const btn = e.target.closest('.shop-subnav-item');
        if (!btn) return;
        container.querySelectorAll('.shop-subnav-item').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.dataset.category;

        const title = document.querySelector('.shop-products-title');
        if (title) {
          const _t = window.I18n ? window.I18n.t : function(k) { return k; };
          title.textContent = currentFilter === 'all' ? _t('shop.shop_all') : btn.textContent;
        }

        renderProducts();
        hidePreview();
        document.getElementById('products').scrollIntoView({ behavior: 'smooth', block: 'start' });
      });

      // Hover â€” show preview for all tabs
      container.addEventListener('mouseover', (e) => {
        const btn = e.target.closest('.shop-subnav-item');
        if (!btn) { return; }
        clearTimeout(hideTimeout);
        hoverTimeout = setTimeout(() => showPreview(btn), 200);
      });

      container.addEventListener('mouseout', (e) => {
        clearTimeout(hoverTimeout);
        const related = e.relatedTarget;
        if (related && (preview.contains(related) || container.contains(related))) return;
        hideTimeout = setTimeout(hidePreview, 300);
      });

      preview.addEventListener('mouseenter', () => clearTimeout(hideTimeout));
      preview.addEventListener('mouseleave', () => {
        hideTimeout = setTimeout(hidePreview, 200);
      });

      function showPreview(btn) {
        const category = btn.dataset.category;
        const items = allProducts.filter(p => {
          if (category === 'all') return true;
          if (category === 'courses') return p.type === 'course';
          return p.category === category;
        });

        if (items.length === 0) { hidePreview(); return; }

        // Position preview under the hovered tab
        const btnRect = btn.getBoundingClientRect();
        const navRect = document.getElementById('shop-subnav').getBoundingClientRect();
        preview.style.left = Math.max(8, btnRect.left - navRect.left - 20) + 'px';

        previewInner.innerHTML = items.slice(0, 8).map(p => `
            <div class="preview-item" data-id="${p.id}" data-category="${p.category}">
              <span class="preview-item-name">${tp(p, 'name')}</span>
            </div>`
        ).join('') + `
          <div class="preview-view-all" data-category="${category}">
            ${window.I18n ? window.I18n.t('shop.view_all') : 'View All'} ${btn.textContent} &#8594;
          </div>`;

        // Click item â†’ scroll to it
        previewInner.querySelectorAll('.preview-item').forEach(item => {
          item.addEventListener('click', () => {
            // Switch tab
            container.querySelectorAll('.shop-subnav-item').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentFilter = category;
            const title = document.querySelector('.shop-products-title');
            if (title) title.textContent = currentFilter === 'all' ? (window.I18n ? window.I18n.t('shop.shop_all') : 'Shop All') : btn.textContent;
            renderProducts();
            hidePreview();
            setTimeout(() => {
              const card = document.querySelector(`[data-product-id="${item.dataset.id}"]`);
              if (card) {
                card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                card.classList.add('search-highlight');
                setTimeout(() => card.classList.remove('search-highlight'), 2000);
              }
            }, 100);
          });
        });

        // View all link
        const viewAll = previewInner.querySelector('.preview-view-all');
        if (viewAll) {
          viewAll.addEventListener('click', () => {
            btn.click();
            hidePreview();
          });
        }

        preview.classList.add('active');
      }

      function hidePreview() {
        preview.classList.remove('active');
      }
    }

    /* ---- SORT DROPDOWN ---- */
    function setupSortDropdown() {
      const select = document.getElementById('sort-select');
      if (!select) return;
      select.addEventListener('change', () => {
        currentSort = select.value;
        renderProducts();
      });
    }

    /* ---- ADD TO CART ---- */
    function handleAddToCart(product) {
      if (typeof CartService !== 'undefined') {
        CartService.addItem(product.id, 1);
        CartService.openDrawer();
      } else {
        // Fallback to Whop checkout
        const user = window.AuthService?.getUser?.();
        if (user && user.email) {
          WhopService.createCheckout(product.id, user.email);
        } else {
          showEmailModal(product.id);
        }
      }
    }

    /* ---- CART DRAWER ---- */
    function setupCartDrawer() {
      const toggle = document.getElementById('cart-toggle');
      const close = document.getElementById('cart-close');
      const overlay = document.getElementById('cart-overlay');
      const startShopping = document.getElementById('start-shopping-btn');

      if (toggle) toggle.addEventListener('click', () => {
        if (typeof CartService !== 'undefined') CartService.openDrawer();
      });
      if (close) close.addEventListener('click', () => {
        if (typeof CartService !== 'undefined') CartService.closeDrawer();
      });
      if (overlay) overlay.addEventListener('click', () => {
        if (typeof CartService !== 'undefined') CartService.closeDrawer();
      });
      if (startShopping) startShopping.addEventListener('click', (e) => {
        e.preventDefault();
        if (typeof CartService !== 'undefined') CartService.closeDrawer();
        document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
      });

      // Checkout button
      const checkoutBtn = document.getElementById('cart-checkout');
      if (checkoutBtn) {
        checkoutBtn.addEventListener('click', () => {
          if (typeof CartService === 'undefined') return;
          const items = CartService.getItems();
          if (items.length === 0) return;
          // For now, checkout first item via Whop
          const user = window.AuthService?.getUser?.();
          if (user && user.email) {
            WhopService.createCheckout(items[0].productId, user.email);
          } else {
            showEmailModal(items[0].productId);
          }
        });
      }
    }

    /* ---- FREQUENTLY BOUGHT TOGETHER ---- */
    function renderFBT() {
      const container = document.getElementById('fbt-container');
      if (!container || allProducts.length < 3) return;

      // Pick 3 complementary products
      const fbtItems = allProducts
        .filter(p => p.featured || p.badge === 'best-seller')
        .slice(0, 3);

      if (fbtItems.length < 3) return;

      const combined = fbtItems.reduce((sum, p) => sum + p.price, 0);
      const discounted = combined * 0.9; // 10% bundle discount

      container.innerHTML = fbtItems.map((item, i) => `
        ${i > 0 ? '<span class="fbt-plus">+</span>' : ''}
        <div class="fbt-item">
          ${item.image
            ? `<img src="${item.image}" alt="${tp(item, 'name')}" loading="lazy">`
            : `<div class="fbt-placeholder"><img src="assets/shop/logo-glow.png" alt="${tp(item, 'name')}" class="fbt-logo-img" loading="lazy"></div>`}
          <p>${tp(item, 'name')}</p>
          <span>${fp(item.price)}</span>
        </div>
      `).join('') + `
        <div class="fbt-total">
          <p>Total: <span class="fbt-combined-price">${fp(discounted)}</span> <span class="fbt-original">${fp(combined)}</span></p>
          <button class="btn btn-primary btn-sm fbt-add-all">${window.I18n ? window.I18n.t('shop.fbt_add_all') : 'Add All 3 to Cart'}</button>
        </div>
      `;

      // Add all handler
      const addAllBtn = container.querySelector('.fbt-add-all');
      if (addAllBtn) {
        addAllBtn.addEventListener('click', () => {
          fbtItems.forEach(item => {
            if (typeof CartService !== 'undefined') CartService.addItem(item.id, 1);
          });
          if (typeof CartService !== 'undefined') CartService.openDrawer();
        });
      }
    }

    /* ---- COURSES CAROUSEL ---- */
    function renderCoursesCarousel() {
      const carousel = document.getElementById('courses-carousel');
      if (!carousel) return;

      const courses = allProducts.filter(p => p.type === 'course');
      if (courses.length === 0) return;

      carousel.innerHTML = courses.map(course => {
        const starPercent = ((course.rating || 0) / 5) * 100;
        const _t = window.I18n ? window.I18n.t : function(k) { return k; };
        return `
          <div class="carousel-course-card">
            <div class="carousel-course-img">
              ${course.image
                ? `<img src="${course.image}" alt="${tp(course, 'name')}" loading="lazy">`
                : `<div class="product-placeholder-img"><img src="assets/shop/logo-glow.png" alt="${tp(course, 'name')}" class="placeholder-logo-img" loading="lazy"></div>`}
              ${course.duration ? `<span class="course-duration-badge">${course.duration}</span>` : ''}
            </div>
            <div class="carousel-course-info">
              ${course.level ? `<span class="course-level level-${course.level}">${course.level.charAt(0).toUpperCase() + course.level.slice(1)}</span>` : ''}
              <h4>${tp(course, 'name')}</h4>
              <p class="course-instructor">${course.instructor || 'AutoNateAI Team'}</p>
              <div class="product-rating-row">
                <div class="star-rating">
                  <span class="stars-bg">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
                  <span class="stars-filled" style="width:${starPercent}%">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
                </div>
                <span class="review-count">(${(course.reviewCount || 0).toLocaleString()} ${_t('shop.students')})</span>
              </div>
              <div class="product-price-row">
                <span class="product-price">${fp(course.price)}</span>
                ${course.originalPrice ? `<span class="product-price-original">${fp(course.originalPrice)}</span>` : ''}
              </div>
              <a href="${course.courseUrl || '#'}" class="btn btn-primary btn-sm">${window.I18n ? window.I18n.t('shop.enroll_now') : 'Enroll Now'} &#8594;</a>
            </div>
          </div>
        `;
      }).join('');

      // Carousel navigation
      const prev = document.getElementById('courses-prev');
      const next = document.getElementById('courses-next');
      if (prev) prev.addEventListener('click', () => {
        carousel.scrollBy({ left: -320, behavior: 'smooth' });
      });
      if (next) next.addEventListener('click', () => {
        carousel.scrollBy({ left: 320, behavior: 'smooth' });
      });
    }

    /* ---- COUNTDOWN TIMER ---- */
    function setupCountdown() {
      // Set drop date to 7 days from now
      const dropDate = new Date();
      dropDate.setDate(dropDate.getDate() + 7);
      dropDate.setHours(0, 0, 0, 0);

      function tick() {
        const now = Date.now();
        const diff = dropDate.getTime() - now;

        if (diff <= 0) {
          const _t = window.I18n ? window.I18n.t : function(k) { return k; };
          document.getElementById('drop-countdown').innerHTML = '<span class="drop-live">' + _t('shop.drop_live') + ' &#128293;</span>';
          return;
        }

        const days = Math.floor(diff / 86400000);
        const hours = Math.floor((diff % 86400000) / 3600000);
        const mins = Math.floor((diff % 3600000) / 60000);
        const secs = Math.floor((diff % 60000) / 1000);

        const pad = (n) => String(n).padStart(2, '0');
        const setEl = (id, val) => { const el = document.getElementById(id); if (el) el.textContent = pad(val); };

        setEl('cd-days', days);
        setEl('cd-hours', hours);
        setEl('cd-mins', mins);
        setEl('cd-secs', secs);
      }

      tick();
      setInterval(tick, 1000);
    }

    /* ---- SEARCH ---- */
    function setupSearch() {
      const toggle = document.getElementById('search-toggle');
      const overlay = document.getElementById('search-overlay');
      const close = document.getElementById('search-close');
      const input = document.getElementById('search-input');
      const results = document.getElementById('search-results');
      const countEl = document.getElementById('search-count');
      const chipsContainer = document.getElementById('search-chips');
      let searchFilter = 'all';

      if (!toggle || !overlay) return;

      function openSearch() {
        overlay.classList.add('active');
        setTimeout(() => input.focus(), 200);
      }

      function closeSearch() {
        overlay.classList.remove('active');
        input.value = '';
        results.innerHTML = '';
        if (countEl) countEl.textContent = '';
        searchFilter = 'all';
        chipsContainer.querySelectorAll('.search-chip').forEach(c => c.classList.remove('active'));
        chipsContainer.querySelector('[data-filter="all"]').classList.add('active');
      }

      toggle.addEventListener('click', openSearch);
      close.addEventListener('click', closeSearch);
      overlay.addEventListener('click', (e) => { if (e.target === overlay) closeSearch(); });

      // Keyboard shortcut: "/" to open search
      document.addEventListener('keydown', (e) => {
        if (e.key === '/' && !overlay.classList.contains('active') && !['INPUT', 'TEXTAREA'].includes(document.activeElement.tagName)) {
          e.preventDefault();
          openSearch();
        }
        if (e.key === 'Escape' && overlay.classList.contains('active')) {
          closeSearch();
        }
      });

      // Filter chips
      chipsContainer.addEventListener('click', (e) => {
        const chip = e.target.closest('.search-chip');
        if (!chip) return;
        chipsContainer.querySelectorAll('.search-chip').forEach(c => c.classList.remove('active'));
        chip.classList.add('active');
        searchFilter = chip.dataset.filter;
        runSearch();
      });

      // Search input
      input.addEventListener('input', runSearch);

      function runSearch() {
        const query = input.value.trim().toLowerCase();
        if (query.length < 1) {
          results.innerHTML = '';
          if (countEl) countEl.textContent = '';
          return;
        }

        let matches = allProducts.filter(p => {
          const matchesQuery =
            p.name.toLowerCase().includes(query) ||
            (p.description && p.description.toLowerCase().includes(query)) ||
            (p.tags && p.tags.some(t => t.toLowerCase().includes(query))) ||
            (p.category && p.category.toLowerCase().includes(query));

          if (!matchesQuery) return false;

          if (searchFilter === 'all') return true;
          if (searchFilter === 'courses') return p.type === 'course';
          return p.category === searchFilter;
        });

        if (countEl) countEl.textContent = `${matches.length} result${matches.length !== 1 ? 's' : ''}`;

        if (matches.length === 0) {
          results.innerHTML = `
            <div class="search-empty">
              <span class="search-empty-icon">&#128269;</span>
              <p>No results for "<strong>${query}</strong>"</p>
              <span class="search-empty-hint">Try searching for "hoodie", "tee", or "course"</span>
            </div>`;
          return;
        }

        results.innerHTML = matches.slice(0, 10).map(p => {
          const categoryLabel = formatCategory(p.category);
          const typeIcon = p.type === 'course' ? '&#127891;' : p.type === 'bundle' ? '&#127873;' : '&#128722;';
          const imageHtml = p.image
            ? `<img src="${p.image}" alt="${p.name}" class="search-result-img">`
            : `<div class="search-result-img search-result-placeholder"><img src="assets/shop/logo-glow.png" alt="" class="search-placeholder-logo"></div>`;
          return `
            <div class="search-result-item" data-id="${p.id}" data-category="${p.category}">
              ${imageHtml}
              <div class="search-result-info">
                <div class="search-result-name">${highlightMatch(p.name, query)}</div>
                <span class="search-result-category">${typeIcon} ${categoryLabel}</span>
              </div>
              <div class="search-result-price">${fp(p.price)}</div>
            </div>`;
        }).join('');

        // Click result â†’ switch to tab + scroll to product
        results.querySelectorAll('.search-result-item').forEach(item => {
          item.addEventListener('click', () => {
            const category = item.dataset.category;
            // Switch subnav tab
            const subnavBtn = document.querySelector(`.shop-subnav-item[data-category="${category}"]`)
              || document.querySelector('.shop-subnav-item[data-category="all"]');
            if (subnavBtn) {
              document.querySelectorAll('.shop-subnav-item').forEach(b => b.classList.remove('active'));
              subnavBtn.classList.add('active');
              currentFilter = subnavBtn.dataset.category;
              const title = document.querySelector('.shop-products-title');
              if (title) title.textContent = currentFilter === 'all' ? (window.I18n ? window.I18n.t('shop.shop_all') : 'Shop All') : subnavBtn.textContent;
              renderProducts();
            }
            closeSearch();
            // Scroll to card after render
            setTimeout(() => {
              const card = document.querySelector(`[data-product-id="${item.dataset.id}"]`);
              if (card) {
                card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                card.classList.add('search-highlight');
                setTimeout(() => card.classList.remove('search-highlight'), 2000);
              }
            }, 100);
          });
        });
      }

      function formatCategory(cat) {
        if (!cat) return '';
        return cat.replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
      }

      function highlightMatch(text, query) {
        const idx = text.toLowerCase().indexOf(query);
        if (idx === -1) return text;
        return text.slice(0, idx) + '<mark class="search-highlight-text">' + text.slice(idx, idx + query.length) + '</mark>' + text.slice(idx + query.length);
      }
    }

    /* ---- MEMBERS AUTH ---- */
    function setupMembersAuth() {
      // Check auth state and hide join CTAs if logged in
      if (typeof firebase !== 'undefined' && firebase.auth) {
        firebase.auth().onAuthStateChanged(user => {
          const ctas = document.getElementById('members-ctas');
          if (ctas && user) {
            const _t = window.I18n ? window.I18n.t : function(k) { return k; };
            ctas.innerHTML = `
              <a href="dashboard/index.html" class="btn btn-primary">${_t('shop.go_dashboard')}</a>
              <a href="dashboard/library.html" class="btn btn-secondary">${_t('shop.my_library')}</a>
              <a href="dashboard/orders.html" class="btn btn-secondary">${_t('nav.orders')}</a>
            `;
          }
        });
      }
    }

    /* ---- ENTRY ANIMATIONS ---- */
    function runEntryAnimations() {
      const manifestoLayer = document.querySelector('.manifesto-layer');
      const heroLayer = document.querySelector('.hero-layer');

      // Manifesto â€” staggered reveal
      anime({
        targets: '.manifesto-lead',
        opacity: [0, 1],
        translateY: [20, 0],
        duration: 800,
        delay: 100,
        easing: 'easeOutCubic'
      });

      anime({
        targets: '.manifesto-headline',
        opacity: [0, 1],
        translateY: [30, 0],
        duration: 900,
        delay: 400,
        easing: 'easeOutCubic'
      });

      anime({
        targets: '.manifesto-body p',
        opacity: [0, 1],
        translateY: [20, 0],
        delay: anime.stagger(200, { start: 700 }),
        duration: 700,
        easing: 'easeOutCubic'
      });

      anime({
        targets: '.manifesto-tagline',
        opacity: [0, 1],
        scale: [0.9, 1],
        duration: 800,
        delay: 1800,
        easing: 'easeOutCubic'
      });

      // Looping crossfade between manifesto â†” hero
      let showingManifesto = true;
      const crossfadeDelay = 3500;  // time each layer is visible
      const cycleDuration = 6000;   // full cycle time

      function crossfade() {
        if (showingManifesto) {
          manifestoLayer.classList.add('fade-out');
          heroLayer.classList.add('fade-in');
        } else {
          manifestoLayer.classList.remove('fade-out');
          heroLayer.classList.remove('fade-in');
        }
        showingManifesto = !showingManifesto;
      }

      // First crossfade after manifesto text finishes
      setTimeout(() => {
        crossfade();
        // Then loop
        setInterval(crossfade, cycleDuration);
      }, crossfadeDelay);

      // Hero content â€” keep visible (no delayed fade, it loops)
      anime({
        targets: '.shop-hero-text',
        opacity: [0, 1],
        translateY: [40, 0],
        duration: 900,
        delay: 4200,
        easing: 'easeOutCubic'
      });

      anime({
        targets: '.shop-hero-image',
        opacity: [0, 1],
        translateX: [60, 0],
        duration: 900,
        delay: 4400,
        easing: 'easeOutCubic'
      });

      anime({
        targets: '.trust-badges',
        opacity: [0, 1],
        translateY: [20, 0],
        duration: 600,
        delay: 4700,
        easing: 'easeOutCubic'
      });

      anime({
        targets: '.shop-subnav',
        opacity: [0, 1],
        translateY: [-10, 0],
        duration: 500,
        delay: 300,
        easing: 'easeOutCubic'
      });

      // Scroll-triggered animations
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate-in');
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.15 });

      document.querySelectorAll('.fbt-section, .courses-section, .drop-section, .social-proof-strip, .community-gallery, .members-section').forEach(el => {
        el.classList.add('animate-target');
        observer.observe(el);
      });
    }

    /* ---- EMAIL MODAL (fallback for non-cart checkout) ---- */
    function showEmailModal(productId) {
      const product = WhopService.getProduct(productId);
      if (!product) return;

      const overlay = document.createElement('div');
      overlay.className = 'email-modal-overlay';
      const _t = window.I18n ? window.I18n.t : function(k) { return k; };
      overlay.innerHTML = `
        <div class="email-modal">
          <h3>${_t('shop.complete_purchase')}</h3>
          <p>${_t('shop.enter_email')} <strong>${tp(product, 'name')}</strong> for ${fp(product.price)}.</p>
          <input type="email" id="checkout-email" placeholder="your@email.com" autocomplete="email">
          <div class="email-modal-actions">
            <button class="btn-cancel" id="modal-cancel">${_t('shop.cancel')}</button>
            <button class="btn-buy" id="modal-confirm">${_t('shop.continue_checkout')} <span>&#8594;</span></button>
          </div>
        </div>
      `;

      document.body.appendChild(overlay);
      const emailInput = overlay.querySelector('#checkout-email');
      emailInput.focus();

      overlay.querySelector('#modal-confirm').addEventListener('click', () => {
        const email = emailInput.value.trim();
        if (!email || !email.includes('@')) { emailInput.style.borderColor = 'var(--accent-error)'; return; }
        overlay.remove();
        WhopService.createCheckout(productId, email);
      });
      overlay.querySelector('#modal-cancel').addEventListener('click', () => overlay.remove());
      overlay.addEventListener('click', (e) => { if (e.target === overlay) overlay.remove(); });
      emailInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') overlay.querySelector('#modal-confirm').click();
        if (e.key === 'Escape') overlay.remove();
      });
    }

    /* ---- PURCHASE TOAST ---- */
    function showPurchaseToast(result) {
      const name = result.product ? tp(result.product, 'name') : 'your product';
      const toast = document.createElement('div');
      toast.className = 'purchase-toast';
      const _t = window.I18n ? window.I18n.t : function(k) { return k; };
      toast.innerHTML = `
        <span class="purchase-toast-icon">&#9989;</span>
        <div class="purchase-toast-text">
          <span class="purchase-toast-title">${_t('shop.purchase_success')}</span>
          <span class="purchase-toast-desc">${_t('shop.purchase_access')} ${name}.</span>
        </div>
        <button class="purchase-toast-close" aria-label="Close">&times;</button>
      `;
      document.body.appendChild(toast);
      toast.querySelector('.purchase-toast-close').addEventListener('click', () => toast.remove());
      setTimeout(() => { if (toast.parentNode) toast.remove(); }, 6000);
    }
  </script>
  <script src="shared/js/i18n.js"></script>
</body>
</html>
